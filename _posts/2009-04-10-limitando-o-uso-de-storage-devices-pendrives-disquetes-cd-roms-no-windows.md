---
id: 866
title: 'Limitando o uso de Storage Devices (PenDrives, Disquetes, Cd-Rom’s) no Windows'
date: '2009-04-10T18:04:36-04:00'
author: rmmartins
layout: post
guid: 'http://ricardomartins.com.br/?p=866'
permalink: /limitando-o-uso-de-storage-devices-pendrives-disquetes-cd-roms-no-windows/
views:
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
    - '3800'
Thumbnail:
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://www.ricardomartins.com.br/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.ne/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.ne/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.ne/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.ne/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.ne/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.ne/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.ne/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.ne/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.net/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.net/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.net/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.net/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.net/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.net/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.net/wp-content/uploads/2009/04/windows_xp_logo.jpg'
    - 'http://ricardomartinsblog.azurewebsites.net/wp-content/uploads/2009/04/windows_xp_logo.jpg'
adman_disable:
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
    - 'on'
dsq_thread_id:
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
    - '3391710140'
categories:
    - Uncategorized
tags:
    - '143'
    - '172'
    - pendrive
    - Segurança
---

Este artigo mostra como realizar uma configuração no windows, de modo a bloquear o acesso à storage devices, que podem ser entendidos como pendrives, disquetes e cd-roms, pelos usuários nas máquinas com Windows Xp. Desta forma, podemos diminuir drasticamente a incidência de vírus, spywares e malwares na sua rede.

O Windows possui uma ferramenta chamada Group Policy Editor, que permite que se façam alterações nas permições e políticas de segurança da máquina. Essa ferramenta permite ainda a criação de novos templates de segurança com um pouco de programação em que na sua maioria já se encontra pronta ou semi-pronta.

Primeiramente deve-se gerar um arquivo de template, que deve ser um arquivo do tipo Custom\_Usb\_ Policy\_Teste.adm, feito no bloco de notas e salvo neste formato com texto em UNICODE. O código dentro do arquivo é o que segue:

`CLASS MACHINE<br></br>CATEGORY !!category<br></br>CATEGORY !!categoryname<br></br>POLICY !!policynameusb<br></br>KEYNAME “SYSTEMCurrentControlSetServicesUSBSTOR”<br></br>EXPLAIN !!explaintextusb<br></br>PART !!labeltextusb DROPDOWNLIST REQUIRED``VALUENAME "Start"<br></br>ITEMLIST<br></br>NAME !!Disabled VALUE NUMERIC 3 DEFAULT<br></br>NAME !!Enabled VALUE NUMERIC 4<br></br>END ITEMLIST<br></br>END PART<br></br>END POLICY<br></br>POLICY !!policynamecd<br></br>KEYNAME “SYSTEMCurrentControlSetServicesCdrom”<br></br>EXPLAIN !!explaintextcd<br></br>PART !!labeltextcd DROPDOWNLIST REQUIRED``VALUENAME "Start"<br></br>ITEMLIST<br></br>NAME !!Disabled VALUE NUMERIC 1 DEFAULT<br></br>NAME !!Enabled VALUE NUMERIC 4<br></br>END ITEMLIST<br></br>END PART<br></br>END POLICY<br></br>POLICY !!policynameflpy<br></br>KEYNAME “SYSTEMCurrentControlSetServicesFlpydisk”<br></br>EXPLAIN !!explaintextflpy<br></br>PART !!labeltextflpy DROPDOWNLIST REQUIRED``VALUENAME "Start"<br></br>ITEMLIST<br></br>NAME !!Disabled VALUE NUMERIC 3 DEFAULT<br></br>NAME !!Enabled VALUE NUMERIC 4<br></br>END ITEMLIST<br></br>END PART<br></br>END POLICY<br></br>POLICY !!policynamels120<br></br>KEYNAME “SYSTEMCurrentControlSetServicesSfloppy”<br></br>EXPLAIN !!explaintextls120<br></br>PART !!labeltextls120 DROPDOWNLIST REQUIRED``VALUENAME "Start"<br></br>ITEMLIST<br></br>NAME !!Disabled VALUE NUMERIC 3 DEFAULT<br></br>NAME !!Enabled VALUE NUMERIC 4<br></br>END ITEMLIST<br></br>END PART<br></br>END POLICY<br></br>END CATEGORY<br></br>END CATEGORY``[strings]<br></br>category=”Custom Policy Settings”<br></br>categoryname=”Restrict Drives”<br></br>policynameusb=”Disable USB”<br></br>policynamecd=”Disable CD-ROM”<br></br>policynameflpy=”Disable Floppy”<br></br>policynamels120=”Disable High Capacity Floppy”<br></br>explaintextusb=”Disables the computers USB ports by disabling the usbstor.sys driver”<br></br>explaintextcd=”Disables the computers CD-ROM Drive by disabling the cdrom.sys driver”<br></br>explaintextflpy=”Disables the computers Floppy Drive by disabling the flpydisk.sys driver”<br></br>explaintextls120=”Disables the computers High Capacity Floppy Drive by disabling the sfloppy.sys driver”<br></br>labeltextusb=”Disable USB Ports”<br></br>labeltextcd=”Disable CD-ROM Drive”<br></br>labeltextflpy=”Disable Floppy Drive”<br></br>labeltextls120=”Disable High Capacity Floppy Drive”<br></br>Enabled=”Enabled”<br></br>Disabled=”Disabled”`

Feito isso, deve-se ir em START, RUN e digitar o seguinte comando : gpedit.msc  
Com isso a seguinte tela deverá aparecer:

![](http://adminonline.files.wordpress.com/2007/06/gpoedit.jpg)

Clicando com o botão direito do mouse em Administrative Templates, e posteriormente em Add/Remove Templates, abre-se uma nova janela:

![](http://adminonline.files.wordpress.com/2007/06/gpoedit2.jpg)

Clicando em Add… e adicionando o arquivo criado anteriormente, a tela deve mudar para a seguinte:

![](http://adminonline.files.wordpress.com/2007/06/gpoedit3.jpg)

Feito isso, clica-se em Close e o menu do Group Policy Editor deve ser igual a este:

![](http://adminonline.files.wordpress.com/2007/06/gpoedit41.jpg)

Para que as opções apareçam corretamente deve-se clicar em View e desmarcar a opção que diz Only Show Policies That Can be Fully Managed. Com isso, agora fica muito mais fácil desativar e reativar o uso de pendrives, disquetes até mesmo o cd-rom. Basta entrar em cada uma das opções e fazer o seguinte :

![](http://adminonline.files.wordpress.com/2007/06/gpoedit5.jpg)

Vale lembrar que este método, bloqueia acesso apenas a dispositivos de storage e sendo assim, dispositivos USB, como mouses, teclados e etc, funcionam normalente.

Obs.: Este turorial foi testado no Windows XP Professional. Acredito que no Windows 2000 também funcione. Apenas no Windows XP Home, ele não funciona pois o mesmo não fornece acesso ao gpedit.msc.

Este tutorial, foi feito baseando se nas informações obtidas em: [http://www.petri.co.il/disable\_usb\_disks\_with\_gpo.htm](http://www.petri.co.il/disable_usb_disks_with_gpo.htm)